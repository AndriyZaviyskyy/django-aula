{% extends "formset.html" %}

{% block extrahead %}
    <style type="text/css">
      .row-padded {
        padding: 2px;
        border-bottom: 1px solid #e3e3e3;
      }
      .btn.btnPresent.active,
      .btn.btnPresent:active {
        color: #ffffff;
        text-shadow: 0 -1px 0 rgba(0,0,0,0.25);
        background-color: #51a351;
      }
      .btn.btnFalta.active,
      .btn.btnFalta:active {
        color: #ffffff;
        text-shadow: 0 -1px 0 rgba(0,0,0,0.25);
        background-color: #bd362f;
      }
      .btn.btnJustificada.active,
      .btn.btnJustificada:active {
        color: #ffffff;
        text-shadow: 0 -1px 0 rgba(0,0,0,0.25);
        background-color: #2f96b4;
      }
      .btn.btnRetrard.active,
      .btn.btnRetrard:active {
        color: #ffffff;
        text-shadow: 0 -1px 0 rgba(0,0,0,0.25);
        background-color: #f89406;
      }
    </style>
    
    <script type="text/javascript">
      // Desactiva tots els botons i esborra els valors dels camps hiddens
      function totnet() {
        $(":button").removeClass("active");
        //$(":hidden").attr("value", "");
        $(":hidden").each(function() {
          if($(this).hasClass('presenciaEstat')) {
            $(this).attr("value", "");
          }
        });
      }

      // Canviar el valor del camp hidden corresponent al boto activat
      function actualitzarHidden(boto) {
        id_modif = boto.attr("id_modif");
        value = boto.attr("value");
        hidden = $("#"+id_modif);
        hidden.attr("value", value);
      }

      $(document).ready(
      function($){
          /* Posar tot a ... */
          $("#totpresent").click(function(){
            totnet();
            $(":button").each(function () {
              if($(this).hasClass('btnPresent')) {
                $(this).addClass('active');
                actualitzarHidden($(this));
              }
            });
            return false;
          });
          
          $("#totfalta").click(function(){
            totnet();
            $(":button").each(function () {
              if($(this).hasClass('btnFalta')) {
                $(this).addClass('active');
                actualitzarHidden($(this));
              }
            });
            return false;
          });
          
          $("#horaAnterior").click(function(){
				    totnet();
				    {% for f in formset %}
				      {% if f.hora_anterior == 0  %}
					      $('#id_{{f.prefix}}-estat_0').addClass('active');
                          actualitzarHidden($('#id_{{f.prefix}}-estat_0'));
				      {% endif %}
				      {% if f.hora_anterior == 1  %}
					      $('#id_{{f.prefix}}-estat_1').addClass('active');
                          actualitzarHidden($('#id_{{f.prefix}}-estat_1'));
				      {% endif %}
				    {% endfor %}
				    return false;
          });
          
			    $("#feelLucky").click(function(){
				    totnet();
				    {% for f in formset %}
				      {% if f.prediccio == 0 %}
					      $('#id_{{f.prefix}}-estat_0').addClass('active');
                          actualitzarHidden($('#id_{{f.prefix}}-estat_0'));
				      {% endif %}
				      {% if f.prediccio == 1 %}
					      $('#id_{{f.prefix}}-estat_1').addClass('active');
                          actualitzarHidden($('#id_{{f.prefix}}-estat_1'));
				      {% endif %}
				    {% endfor %}
				    return false;
          });
          
          // Desar dades del boto clicat al camp hidden corrresponent
          $("button").click(function() {
            if ($(this).attr("id_modif")) {
              actualitzarHidden($(this));
            }
          });
        });
    </script>

{% endblock %}


{% block preform  %}



	{% if formset %}
	  <p class="well well-small">
  	  <i class="icon-user"></i> {{ info.professor }}<br />
      <i class="icon-calendar"></i> {{ info.dia_setmana }} {{ info.dia_complet }}<br />
      <i class="icon-time"></i> {{ info.hora }}<br />
      <i class="icon-briefcase"></i> {{ info.assignatura }}<br />
      <i class="icon-home"></i> {{ info.nom_aula }}<br />
      <i class="icon-list"></i> {{ info.grup }}<br />
  	</p>
	
	  <div class="row row-padded">
      <div class="span5 offset6">
        <!--div data-toggle="buttons-radio"-->
          <button type="button" id="totpresent" class="btn btn-primary">Tot<br />Present</button>
          <button type="button" id="totfalta" class="btn btn-primary">Tot<br />Falta</button>
          {% if feelLuckyEnabled %}
            <button type="button" id="feelLucky" class="btn btn-primary">Tinc<br />sort!</button>
          {% endif %}
          <button type="button" id="horaAnterior" class="btn btn-primary">= hora<br />abans</button>
        <!--/div-->
      </div>
    </div>
	{% else %}

		<div style="float:left; margin-left: 100px">
		<ul style="list-style-type:square;padding:10px;">
			<li style="padding:10px;">
			<a href="/presencia/afegeixAlumnesLlista/{{id_impartir}}" > Afegir alumnes a la llista</a>
			</li>
			
			{% if pot_marcar_sense_alumnes %}
			<li style="padding:10px;">
			<a href="/presencia/marcarComHoraSenseAlumnes/{{id_impartir}}" > En aquesta hora no tinc alumnes! </a>
			</li>
			{% endif %}
					
		</ul>
		</div>    
  {% endif %}
{% endblock %}


{% block postform  %}

{% endblock %}


